launch:

- arg: {name: "localization", default: "false"}
- arg: {name: "simulation", default: "false"}
- arg: {name: "frame_id", default: "lidar_base"}
- arg: {name: "qos", default: "0"}

- let: {name: "args", value: "--delete_db_on_start", if: "$(var localization)"}
- let: {name: "args", value: "", unless: "$(var localization)"}

- node:
    pkg: "rtabmap_ros"
    exec: "icp_odometry"
    name: "icp_odometry"
    namespace: "rtabmap"
    output: "log"

    remap:
    - {from: "scan", to: "/lidar/scan"}

    param:
    - {name: "use_sim_time", value: "$(var simulation)"}
    - {name: "qos", value: "$(var qos)"}
    - {name: "frame_id", value: "$(var frame_id)"}
    - {name: "queue_size", value: 1} 
    - {name: "publish_tf", value: True}
    - {name: "scan_cloud_max_points", value: 64000}
    - {name: "wait_imu_to_init", value: False} 
    - {name: "Odom/Strategy", value: "1"}
    - {name: "Odom/ResetCountdown", value: "25"}
    - {name: "Icp/PointToPlane", value: "true"}
